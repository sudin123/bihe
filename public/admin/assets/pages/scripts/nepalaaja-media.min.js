function getPhotos(e,a){var i=$(a).find("#load-more").attr("page-num");$.ajax({type:"GET",dataType:"json",url:"/admin/media/lists",data:{page:i}}).done(function(t){var n=$.parseJSON(t.photos);$(a).find("#load-more").hasClass("loaded-content")&&(window.current_page=n.current_page),(i==n.last_page||n.last_page<=1)&&$(a).find("#load-more").hide(),e(n)}).fail(function(e){console.log("Error: "+e)})}function getSearchedPhotos(e,a){null!=a&&void 0!=a||(a="");var i=window.s_current_page;0==a.length&&(i=window.current_page),$.ajax({type:"GET",dataType:"json",url:"/admin/media/lists",data:{page:i+1,s:a}}).done(function(a){var t=$.parseJSON(a.photos);i=t.s_current_page,(i==t.last_page||t.last_page<=1)&&$("#load-more").hide(),i!=t.last_page&&t.last_page>1&&$("#load-more").show(),e(t)}).fail(function(e){console.log("Error: "+e)})}function displayPhotos(e){var a='<option value=""></option>';$.each(e.data,function(e,i){a=a+'<option class="thumbnail" data-img-src="'+i.thumb_url+'" data-img-alt="'+i.original_name+'" value="'+i.id+'" data-id="'+i.id+'">'+i.original_name+"</option>"}),$(".media-popup").find(".image-picker").append(a),$(".image-picker").imagepicker({show_label:!0,limit:1})}function displaySearchedPhotos(e){var a="";$.each(e.data,function(e,i){a=a+'<option class="thumbnail" data-img-src="'+i.thumb_url+'" data-img-alt="'+i.original_name+'" value="'+i.id+'" data-id="'+i.id+'">'+i.original_name+"</option>"}),$(".media-popup").find(".image-picker").empty(),$(".media-popup").find(".image-picker").append(a),$(".image-picker").imagepicker()}function insertMedia(){$("#ajax-media").on("click",".media-insert",function(e){var a=$(".image-picker").val(),i=$(".media-popup").find(".selected").find("img").attr("src");$(".featured-image-preview").find("img").attr("src",i),$(".featured-image-preview").find('[name="featured_image"]').val(a),$(this).closest(".modal-content").find(".close").trigger("click"),$(".featured-image-preview").hasClass("not-empty")||($(".featured-image-preview").addClass("not-empty"),$(".featured-image-preview").find(".featured-img-new").text("Change Image"),$(".featured-image-preview").find(".featured-img-remove").removeClass("hide"))})}function insertMediaMce(){$("#mce-media").on("click",".mce-media-insert",function(e){var a=$(".media-popup").find(".selected").find("img").attr("src"),i='<img scr="'+a+'" style="max-width: 750px; max-height: 300px;">';return i})}function removeImage(){$(".featured-image-preview").on("click",".featured-img-remove",function(e){$(".featured-image-preview").removeClass("not-empty"),$(".featured-image-preview").find("img").attr("src","http://www.placehold.it/200x150/EFEFEF/AAAAAA&text=no+image"),$(".featured-image-preview").find('[name="featured_image"]').val(""),$(".featured-image-preview").find(".featured-img-new").text("Select Image"),$(this).addClass("hide")})}var current_page=parseInt(0),s_current_page=parseInt(0);tinymce.init({selector:"#post-content",height:500,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste imagetools"],toolbar:"undo redo | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link | custom_media",setup:function(e){e.addButton("custom_media",{icon:"image",tooltip:"Insert Image",onclick:function(){$("#mce-media").modal("show"),imgSrc="",$("#mce-media").on("shown.bs.modal",function(e){$("#mce-media").on("click",".mce-media-insert",function(e){var a=$("div[class='thumbnail selected']").children("img"),i=[];$(a).each(function(e,a){src=$(a).attr("src"),i.push(src)});var t=i[0],n='<img src="'+t+'" style="max-width: 750px; max-height: 300px;">';$(this).closest(".modal-content").find(".close").trigger("click"),tinymce.activeEditor.execCommand("mceInsertContent",!1,n)})})}})}}),removeImage(),$("#ajax-media").on("shown.bs.modal",function(e){$(".image-picker").empty(),getPhotos(function(e){displayPhotos(e),insertMedia()},"#ajax-media")}),$("#mce-media").on("shown.bs.modal",function(e){$(".image-picker").empty(),getPhotos(function(e){displayPhotos(e)},"#mce-media")}),$(".media-search").on("keyup",'[name="s"]',function(){var e=$(this).val();getSearchedPhotos(function(e){displaySearchedPhotos(e),insertMedia(),insertMediaMce()},e)}),$(".media-search").find("form").attr("onsubmit","return false;"),$(document).on("shown.bs.tab",'a[data-toggle="tab"]',function(e){console.log(e.target)}),$(".loadmore-images").on("click",function(e){e.preventDefault();var a=$(this).closest(".modal").attr("id"),i="#"+a,t=parseInt($(this).attr("page-num"));$(this).attr("page-num",t+1),getPhotos(function(e){displayPhotos(e)},i)});